// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}
        
model Event {
  id          String  @id
  name        String  // JSON string for LocalizedString
  description String? // JSON string for LocalizedString (optional)
  startDate   DateTime @map("start_date")
  endDate     DateTime @map("end_date")
  status      Boolean
  image       String? // Optional image URL

  // Relations
  orders   Order[]
  checkIns CheckIn[]

  @@map("events")
}

model Product {
  id          String @id
  name        String // JSON string for LocalizedString
  description String // JSON string for LocalizedString
  image       String

  @@map("products")
}

model Customer {
  id       String @id
  phone    String @unique
  shopName String @map("shop_name")
  joined   DateTime

  // Relations
  checkIns CheckIn[]

  @@map("customers")
}

model Order {
  orderId   String @id @map("order_id")
  shopName  String @map("shop_name")
  eventId   String @map("event_id")
  products  String // JSON string for OrderProduct[]
  total     Int
  orderDate DateTime @map("order_date")

  // Relations
  event Event @relation(fields: [eventId], references: [id])

  @@map("orders")
}

model CheckIn {
  customerId   String   @map("customer_id")
  shopName     String   @map("shop_name")
  phone        String
  eventId      String   @map("event_id")
  checkInTime  DateTime @default(now()) @map("check_in_time")

  // Relations
  customer Customer @relation(fields: [customerId], references: [id])
  event    Event    @relation(fields: [eventId], references: [id])

  @@id([customerId, eventId])
  @@map("check_ins")
}
